@model CheckoutVM
@{
    var cnt = 0;
    var btnDisabled = Model.Address == null || Model.Products.Count == 0;
}

<div class="container min-vh-100 p-2">

    <!-- ĐỊA CHỈ -->
    <div class="card mb-2">
        <div class="card-body">
            <h3>Địa chỉ nhận hàng</h3>

            @if (Model.Address == null)
            {
                <p>
                    Bạn chưa có địa chỉ!
                    <a asp-controller="Address" asp-action="Create">Thêm ngay</a>
                </p>
            }
            else
            {
                <div class="d-flex justify-content-between">
                    <p>
                        @Model.Address.ReceiverName (@Model.Address.Phone) -
                        @Model.Address.AddressLine, @Model.Address.Ward,
                        @Model.Address.District, @Model.Address.Province
                    </p>
                    <a asp-action="ChangeAddress">Thay đổi</a>
                </div>
            }
        </div>
    </div>

    <!-- SẢN PHẨM -->
    <div class="card mb-2">
        <div class="card-body">
            <h3>Sản phẩm</h3>
            <table class="table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Tên</th>
                        <th>Giá</th>
                        <th>SL</th>
                        <th>Thành tiền</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var i in Model.Products)
                    {
                        cnt++;
                        <tr>
                            <td>@cnt</td>
                            <td>@i.Name</td>
                            <td>@CurrencyExtensions.ToVnd(i.Price)</td>
                            <td>@i.OrderQuantity</td>
                            <td>@(CurrencyExtensions.ToVnd(i.Price * i.OrderQuantity))</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <!-- THANH TOÁN -->
    <div class="card">
        <div class="card-body">
            <h3>Phương thức thanh toán</h3>
            <hr />

            <form asp-action="PlaceOrder" method="post">
                @Html.AntiForgeryToken()

                <!-- PAYMENT METHOD -->
                <div class="mb-3">
                    <label class="fw-bold">Chọn phương thức:</label>
                    <div>
                        <input type="radio" name="paymentMethod" value="COD" checked />
                        Thanh toán khi nhận hàng
                    </div>
                    <div>
                        <input type="radio" name="paymentMethod" value="MOMO" />
                        Thanh toán MoMo
                    </div>
                </div>

                <!-- TỔNG TIỀN -->
                <div class="text-end">
                    <p>Tiền hàng: <strong>@Model.Subtotal đ</strong></p>
                    <p>Phí ship: <strong>@Model.ShippingFee đ</strong></p>
                    <p class="fs-4 text-danger">
                        Tổng thanh toán: <strong>
                            @Model.TotalAmount.ToString("N0") đ
                        </strong>
                    </p>
                </div>

                <div class="text-end">
                    <a asp-controller="Cart" asp-action="Index" class="me-3">Quay lại</a>
                    <button class="btn btn-primary" disabled="@btnDisabled">
                        Đặt hàng
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
